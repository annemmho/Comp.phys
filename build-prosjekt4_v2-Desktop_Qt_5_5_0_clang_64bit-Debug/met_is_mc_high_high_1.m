mc = [100000, 200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1e+06, 1.1e+06, 1.2e+06, 1.3e+06, 1.4e+06, 1.5e+06, 1.6e+06, 1.7e+06, 1.8e+06, 1.9e+06, 2e+06, 2.1e+06, 2.2e+06, 2.3e+06, 2.4e+06, 2.5e+06, 2.6e+06, 2.7e+06, 2.8e+06, 2.9e+06, 3e+06, 3.1e+06, 3.2e+06, 3.3e+06, 3.4e+06, 3.5e+06, 3.6e+06, 3.7e+06, 3.8e+06, 3.9e+06, 4e+06, 4.1e+06, 4.2e+06, 4.3e+06, 4.4e+06, 4.5e+06, 4.6e+06, 4.7e+06, 4.8e+06, 4.9e+06, 5e+06, 5.1e+06, 5.2e+06, 5.3e+06, 5.4e+06, 5.5e+06, 5.6e+06, 5.7e+06, 5.8e+06, 5.9e+06, 6e+06, 6.1e+06, 6.2e+06, 6.3e+06, 6.4e+06, 6.5e+06, 6.6e+06, 6.7e+06, 6.8e+06, 6.9e+06, 7e+06, 7.1e+06, 7.2e+06, 7.3e+06, 7.4e+06, 7.5e+06, 7.6e+06, 7.7e+06, 7.8e+06, 7.9e+06, 8e+06, 8.1e+06, 8.2e+06, 8.3e+06, 8.4e+06, 8.5e+06, 8.6e+06, 8.7e+06, 8.8e+06, 8.9e+06, 9e+06, 9.1e+06, 9.2e+06, 9.3e+06, 9.4e+06, 9.5e+06, 9.6e+06, 9.7e+06, 9.8e+06, 9.9e+06, 1e+07, ];
M_var = [0.551985, 0.27712, 0.185352, 0.139435, 0.111867, 0.0934943, 0.0803642, 0.0705219, 0.0628639, 0.0567391, 0.0517209, 0.0475429, 0.0440081, 0.0409781, 0.038352, 0.0360541, 0.0340255, 0.0322221, 0.0306084, 0.0291551, 0.0278425, 0.0266473, 0.0255563, 0.0245574, 0.0236396, 0.0227921, 0.0220062, 0.0212766, 0.0205971, 0.0199627, 0.0193702, 0.0188143, 0.0182916, 0.0178009, 0.0173374, 0.0169, 0.0164865, 0.0160947, 0.015722, 0.0153684, 0.015032, 0.0147121, 0.0144065, 0.0141156, 0.013836, 0.0135688, 0.0133126, 0.013068, 0.0128327, 0.0126062, 0.0123899, 0.0121819, 0.0119824, 0.0117901, 0.0116046, 0.0114249, 0.0112517, 0.0110844, 0.0109227, 0.0107669, 0.0106158, 0.0104693, 0.0103274, 0.010191, 0.0100581, 0.00992948, 0.00980458, 0.00968391, 0.00956633, 0.00945214, 0.00934136, 0.00923384, 0.00912904, 0.00902676, 0.0089273, 0.00883051, 0.00873531, 0.00864277, 0.0085538, 0.008466, 0.00838104, 0.00829865, 0.00821747, 0.00813861, 0.00806112, 0.00798587, 0.0079121, 0.00783984, 0.00776935, 0.00769993, 0.0076323, 0.00756658, 0.00750223, 0.00743887, 0.00737696, 0.00731641, 0.00725721, 0.00719884, 0.007142, 0.00708606, ];
E_var = [0.104497, 0.0640046, 0.050628, 0.0438281, 0.0395923, 0.0369304, 0.0349678, 0.0335777, 0.0324717, 0.0316095, 0.0308116, 0.0302062, 0.0296909, 0.0292389, 0.0288523, 0.0285206, 0.0282102, 0.0279438, 0.0277018, 0.027472, 0.0272889, 0.0270936, 0.0269227, 0.0267762, 0.0266588, 0.0265444, 0.0264289, 0.0263209, 0.0262231, 0.0261237, 0.026048, 0.0259703, 0.0258939, 0.0258298, 0.0257566, 0.0256985, 0.0256482, 0.0256008, 0.0255387, 0.0254901, 0.0254448, 0.0254061, 0.0253591, 0.0253276, 0.0252708, 0.0252262, 0.0251761, 0.0251415, 0.0250943, 0.0250435, 0.025011, 0.0249827, 0.0249615, 0.0249399, 0.0249135, 0.0248793, 0.0248476, 0.0248208, 0.0247909, 0.0247682, 0.0247424, 0.0247096, 0.0246794, 0.0246645, 0.0246393, 0.0246188, 0.0245988, 0.0245872, 0.0245717, 0.0245559, 0.0245421, 0.024533, 0.0245185, 0.0245008, 0.0244846, 0.0244691, 0.0244429, 0.0244198, 0.024412, 0.0243923, 0.0243819, 0.0243767, 0.0243642, 0.0243565, 0.0243424, 0.0243354, 0.0243231, 0.024311, 0.0243003, 0.0242825, 0.0242686, 0.0242619, 0.0242532, 0.0242391, 0.0242287, 0.0242193, 0.0242115, 0.0241988, 0.0241896, 0.0241785, ];
MeanM = [0.997452, 0.998366, 0.998666, 0.99882, 0.998914, 0.998973, 0.999017, 0.999048, 0.999073, 0.999092, 0.999109, 0.999123, 0.999135, 0.999145, 0.999153, 0.999161, 0.999168, 0.999173, 0.999179, 0.999184, 0.999188, 0.999193, 0.999197, 0.9992, 0.999203, 0.999205, 0.999208, 0.99921, 0.999212, 0.999214, 0.999216, 0.999218, 0.99922, 0.999221, 0.999222, 0.999224, 0.999225, 0.999226, 0.999227, 0.999228, 0.999229, 0.99923, 0.999231, 0.999232, 0.999233, 0.999234, 0.999236, 0.999236, 0.999237, 0.999239, 0.999239, 0.99924, 0.99924, 0.999241, 0.999241, 0.999242, 0.999243, 0.999243, 0.999244, 0.999245, 0.999245, 0.999246, 0.999247, 0.999247, 0.999248, 0.999248, 0.999249, 0.999249, 0.999249, 0.99925, 0.99925, 0.99925, 0.99925, 0.999251, 0.999251, 0.999251, 0.999252, 0.999253, 0.999253, 0.999253, 0.999254, 0.999254, 0.999254, 0.999254, 0.999254, 0.999254, 0.999255, 0.999255, 0.999255, 0.999256, 0.999256, 0.999256, 0.999256, 0.999257, 0.999257, 0.999257, 0.999257, 0.999258, 0.999258, 0.999258, ];
Probability = [0, -800, -800, -800, -800, -800, -792, -800, -800, -800, -800, -792, -800, -800, -800, -800, -792, -800, -800, -800, -800, -800, -792, -792, -800, -800, -792, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -784, -800, -800, -792, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -800, -784, -800, -800, -792, -800, -800, -800, -800, -800, -800, -792, -800, -800, -800, -800, -800, -800, -792, -800, -800, -800, -800, -800, -800, -800, -792, -800, -800, -800, -800, -800, -800, ];
E_avg = [-1.99644, -1.99681, -1.99691, -1.99698, -1.99703, -1.99705, -1.99707, -1.99707, -1.99708, -1.99708, -1.99709, -1.9971, -1.9971, -1.99711, -1.99711, -1.99711, -1.99712, -1.99712, -1.99712, -1.99712, -1.99712, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99714, -1.99714, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99713, -1.99714, -1.99713, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99714, -1.99715, -1.99714, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99715, -1.99716, ];
accepted_tot = [0.34375, 0.14337, 0.0969867, 0.07128, 0.056584, 0.0488633, 0.0412643, 0.0364812, 0.0322178, 0.029276, 0.0264164, 0.0239608, 0.0221438, 0.0207929, 0.0193387, 0.0180387, 0.0171888, 0.0161294, 0.0151905, 0.014445, 0.0140286, 0.0129782, 0.01255, 0.0119208, 0.0116716, 0.0112646, 0.0107811, 0.0103961, 0.0100076, 0.00967067, 0.0094529, 0.00899375, 0.00878667, 0.00861, 0.00825371, 0.00808389, 0.00801514, 0.00764211, 0.00740974, 0.0072625, 0.00707756, 0.00691143, 0.00675674, 0.00666045, 0.00643244, 0.00618, 0.0061834, 0.00605, 0.00589388, 0.005704, 0.00563647, 0.005685, 0.00555434, 0.00543407, 0.00531673, 0.00512107, 0.00495982, 0.00501017, 0.00488847, 0.00478867, 0.00470131, 0.00463226, 0.00455429, 0.00456094, 0.00441415, 0.00437515, 0.00430746, 0.00429412, 0.00420899, 0.00417371, 0.00407014, 0.00407625, 0.00402562, 0.00387865, 0.00387573, 0.00384816, 0.00370078, 0.00365154, 0.00366165, 0.00357638, 0.00357481, 0.00357463, 0.00352578, 0.00347452, 0.00343129, 0.00338151, 0.00333575, 0.00331705, 0.00325955, 0.00319978, 0.00317604, 0.00316174, 0.00312882, 0.00304138, 0.00304053, 0.00299, 0.00300969, 0.00294367, 0.00294444, 0.0028704, ];
plot(mc, M_var)
xlabel('Number of Monte Carlo cycles')
ylabel('Susceptibilty')
